{% extends "base.html" %} {% block title %}Configuración - Rentflow{% endblock
%} {% block content %}
<div class="container-fluid py-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1 class="h2"><i class="bi bi-gear"></i> Configuración del Sistema</h1>
    <button class="btn btn-primary" onclick="guardarConfiguracion()">
      <i class="bi bi-check-circle"></i> Guardar Cambios
    </button>
  </div>

  <div class="row">
    <!-- Menú de Configuración -->
    <div class="col-lg-3 mb-4">
      <div class="card">
        <div class="card-header bg-primary text-white">
          <h6 class="mb-0">
            <i class="bi bi-menu-button"></i> Configuraciones
          </h6>
        </div>
        <div class="list-group list-group-flush">
          <a
            href="#general"
            class="list-group-item list-group-item-action active"
            data-bs-toggle="list"
          >
            <i class="bi bi-sliders me-2"></i> General
          </a>
          <a
            href="#usuarios"
            class="list-group-item list-group-item-action"
            data-bs-toggle="list"
          >
            <i class="bi bi-people me-2"></i> Usuarios
          </a>
          <a
            href="#objetos"
            class="list-group-item list-group-item-action"
            data-bs-toggle="list"
          >
            <i class="bi bi-grid me-2"></i> Objetos
          </a>
          <a
            href="#pagos"
            class="list-group-item list-group-item-action"
            data-bs-toggle="list"
          >
            <i class="bi bi-credit-card me-2"></i> Pagos
          </a>
          <a
            href="#notificaciones"
            class="list-group-item list-group-item-action"
            data-bs-toggle="list"
          >
            <i class="bi bi-bell me-2"></i> Notificaciones
          </a>
          <a
            href="#seguridad"
            class="list-group-item list-group-item-action"
            data-bs-toggle="list"
          >
            <i class="bi bi-shield-lock me-2"></i> Seguridad
          </a>
        </div>
      </div>
    </div>

    <!-- Contenido de Configuración -->
    <div class="col-lg-9">
      <div class="tab-content">
        <!-- Configuración General -->
        <div class="tab-pane fade show active" id="general">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="bi bi-sliders"></i> Configuración General
              </h5>
            </div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label">Nombre de la Plataforma</label>
                <input
                  type="text"
                  class="form-control"
                  value="Rentflow"
                  id="nombrePlataforma"
                />
              </div>
              <div class="mb-3">
                <label class="form-label">Descripción</label>
                <textarea
                  class="form-control"
                  rows="3"
                  id="descripcionPlataforma"
                >
Plataforma de alquiler de objetos entre particulares</textarea
                >
              </div>
              <div class="mb-3">
                <label class="form-label">Moneda</label>
                <select class="form-select" id="moneda">
                  <option value="DOP" selected>Peso Dominicano (DOP)</option>
                  <option value="USD">Dólar Americano (USD)</option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Zona Horaria</label>
                <select class="form-select" id="zonaHoraria">
                  <option value="-4" selected>
                    UTC-4 (República Dominicana)
                  </option>
                  <option value="-5">UTC-5</option>
                  <option value="-6">UTC-6</option>
                </select>
              </div>
              <div class="form-check form-switch mb-3">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="mantenimientoMode"
                  checked
                />
                <label class="form-check-label" for="mantenimientoMode">
                  Modo mantenimiento
                </label>
              </div>
            </div>
          </div>
        </div>

        <!-- Configuración de Usuarios -->
        <div class="tab-pane fade" id="usuarios">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="bi bi-people"></i> Configuración de Usuarios
              </h5>
            </div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label">Registro de Usuarios</label>
                <select class="form-select" id="registroUsuarios">
                  <option value="abierto" selected>
                    Abierto - Cualquiera puede registrarse
                  </option>
                  <option value="invitacion">Solo por invitación</option>
                  <option value="cerrado">
                    Cerrado - Solo administradores
                  </option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Verificación de Email</label>
                <select class="form-select" id="verificacionEmail">
                  <option value="requerida" selected>Requerida</option>
                  <option value="opcional">Opcional</option>
                  <option value="no">No requerida</option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Límite de Objetos por Usuario</label>
                <input
                  type="number"
                  class="form-control"
                  value="10"
                  id="limiteObjetos"
                  min="1"
                  max="100"
                />
              </div>
              <div class="form-check form-switch mb-3">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="perfilesPublicos"
                  checked
                />
                <label class="form-check-label" for="perfilesPublicos">
                  Perfiles públicos
                </label>
              </div>
            </div>
          </div>
        </div>

        <!-- Configuración de Objetos -->
        <div class="tab-pane fade" id="objetos">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="bi bi-grid"></i> Configuración de Objetos
              </h5>
            </div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label">Moderación de Objetos</label>
                <select class="form-select" id="moderacionObjetos">
                  <option value="automatica" selected>
                    Aprobación automática
                  </option>
                  <option value="manual">
                    Aprobación manual por administradores
                  </option>
                </select>
              </div>
              <div class="mb-3">
                <label class="form-label">Límite de Imágenes por Objeto</label>
                <input
                  type="number"
                  class="form-control"
                  value="5"
                  id="limiteImagenes"
                  min="1"
                  max="10"
                />
              </div>
              <div class="mb-3">
                <label class="form-label">Precio Mínimo por Día</label>
                <div class="input-group">
                  <span class="input-group-text">RD$</span>
                  <input
                    type="number"
                    class="form-control"
                    value="50"
                    id="precioMinimo"
                    step="0.01"
                  />
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Precio Máximo por Día</label>
                <div class="input-group">
                  <span class="input-group-text">RD$</span>
                  <input
                    type="number"
                    class="form-control"
                    value="5000"
                    id="precioMaximo"
                    step="0.01"
                  />
                </div>
              </div>
              <div class="form-check form-switch mb-3">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="calificacionesObjetos"
                  checked
                />
                <label class="form-check-label" for="calificacionesObjetos">
                  Sistema de calificaciones para objetos
                </label>
              </div>
            </div>
          </div>
        </div>

        <!-- Configuración de Pagos -->
        <div class="tab-pane fade" id="pagos">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="bi bi-credit-card"></i> Configuración de Pagos
              </h5>
            </div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label">Comisión de la Plataforma</label>
                <div class="input-group">
                  <input
                    type="number"
                    class="form-control"
                    value="10"
                    id="comisionPlataforma"
                    step="0.1"
                    min="0"
                    max="50"
                  />
                  <span class="input-group-text">%</span>
                </div>
                <div class="form-text">
                  Porcentaje que se retiene por cada transacción exitosa
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Métodos de Pago Disponibles</label>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="pagoTarjeta"
                    checked
                  />
                  <label class="form-check-label" for="pagoTarjeta">
                    Tarjeta de Crédito/Débito
                  </label>
                </div>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="pagoTransferencia"
                    checked
                  />
                  <label class="form-check-label" for="pagoTransferencia">
                    Transferencia Bancaria
                  </label>
                </div>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="pagoEfectivo"
                    checked
                  />
                  <label class="form-check-label" for="pagoEfectivo">
                    Efectivo
                  </label>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label"
                  >Días para Liberar Pago al Propietario</label
                >
                <input
                  type="number"
                  class="form-control"
                  value="3"
                  id="diasLiberacionPago"
                  min="1"
                  max="30"
                />
                <div class="form-text">
                  Número de días después de la finalización de la reserva para
                  liberar el pago al propietario
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Configuración de Notificaciones -->
        <div class="tab-pane fade" id="notificaciones">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="bi bi-bell"></i> Configuración de Notificaciones
              </h5>
            </div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label">Notificaciones por Email</label>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="notifNuevosUsuarios"
                    checked
                  />
                  <label class="form-check-label" for="notifNuevosUsuarios">
                    Nuevos usuarios registrados
                  </label>
                </div>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="notifNuevosObjetos"
                    checked
                  />
                  <label class="form-check-label" for="notifNuevosObjetos">
                    Nuevos objetos publicados
                  </label>
                </div>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="notifNuevasReservas"
                    checked
                  />
                  <label class="form-check-label" for="notifNuevasReservas">
                    Nuevas reservas
                  </label>
                </div>
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="notifIncidencias"
                    checked
                  />
                  <label class="form-check-label" for="notifIncidencias">
                    Nuevas incidencias reportadas
                  </label>
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label"
                  >Email del Administrador para Notificaciones</label
                >
                <input
                  type="email"
                  class="form-control"
                  value="admin@rentflow.com"
                  id="emailNotificaciones"
                />
              </div>
            </div>
          </div>
        </div>

        <!-- Configuración de Seguridad -->
        <div class="tab-pane fade" id="seguridad">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0">
                <i class="bi bi-shield-lock"></i> Configuración de Seguridad
              </h5>
            </div>
            <div class="card-body">
              <div class="mb-3">
                <label class="form-label">Longitud Mínima de Contraseña</label>
                <input
                  type="number"
                  class="form-control"
                  value="6"
                  id="longitudPassword"
                  min="4"
                  max="20"
                />
              </div>
              <div class="mb-3">
                <label class="form-label">Intentos de Login Fallidos</label>
                <input
                  type="number"
                  class="form-control"
                  value="5"
                  id="intentosLogin"
                  min="1"
                  max="10"
                />
                <div class="form-text">
                  Número de intentos fallidos antes de bloquear la cuenta
                  temporalmente
                </div>
              </div>
              <div class="mb-3">
                <label class="form-label">Tiempo de Expiración de Sesión</label>
                <select class="form-select" id="expiracionSesion">
                  <option value="1">1 hora</option>
                  <option value="4">4 horas</option>
                  <option value="8" selected>8 horas</option>
                  <option value="24">24 horas</option>
                </select>
              </div>
              <div class="form-check form-switch mb-3">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="httpsForzado"
                  checked
                />
                <label class="form-check-label" for="httpsForzado">
                  Forzar conexión HTTPS
                </label>
              </div>
              <div class="form-check form-switch mb-3">
                <input
                  class="form-check-input"
                  type="checkbox"
                  id="autenticacionDosFactores"
                />
                <label class="form-check-label" for="autenticacionDosFactores">
                  Autenticación de dos factores para administradores
                </label>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  function guardarConfiguracion() {
    // Recopilar todos los valores de configuración
    const configuracion = {
      general: {
        nombrePlataforma: document.getElementById("nombrePlataforma").value,
        descripcionPlataforma: document.getElementById("descripcionPlataforma")
          .value,
        moneda: document.getElementById("moneda").value,
        zonaHoraria: document.getElementById("zonaHoraria").value,
        mantenimientoMode: document.getElementById("mantenimientoMode").checked,
      },
      usuarios: {
        registroUsuarios: document.getElementById("registroUsuarios").value,
        verificacionEmail: document.getElementById("verificacionEmail").value,
        limiteObjetos: document.getElementById("limiteObjetos").value,
        perfilesPublicos: document.getElementById("perfilesPublicos").checked,
      },
      objetos: {
        moderacionObjetos: document.getElementById("moderacionObjetos").value,
        limiteImagenes: document.getElementById("limiteImagenes").value,
        precioMinimo: document.getElementById("precioMinimo").value,
        precioMaximo: document.getElementById("precioMaximo").value,
        calificacionesObjetos: document.getElementById("calificacionesObjetos")
          .checked,
      },
      pagos: {
        comisionPlataforma: document.getElementById("comisionPlataforma").value,
        metodosPago: {
          tarjeta: document.getElementById("pagoTarjeta").checked,
          transferencia: document.getElementById("pagoTransferencia").checked,
          efectivo: document.getElementById("pagoEfectivo").checked,
        },
        diasLiberacionPago: document.getElementById("diasLiberacionPago").value,
      },
      notificaciones: {
        nuevosUsuarios: document.getElementById("notifNuevosUsuarios").checked,
        nuevosObjetos: document.getElementById("notifNuevosObjetos").checked,
        nuevasReservas: document.getElementById("notifNuevasReservas").checked,
        incidencias: document.getElementById("notifIncidencias").checked,
        emailNotificaciones: document.getElementById("emailNotificaciones")
          .value,
      },
      seguridad: {
        longitudPassword: document.getElementById("longitudPassword").value,
        intentosLogin: document.getElementById("intentosLogin").value,
        expiracionSesion: document.getElementById("expiracionSesion").value,
        httpsForzado: document.getElementById("httpsForzado").checked,
        autenticacionDosFactores: document.getElementById(
          "autenticacionDosFactores"
        ).checked,
      },
    };

    // Aquí iría la llamada AJAX para guardar la configuración
    console.log("Guardando configuración:", configuracion);
    alert("Configuración guardada correctamente");

    // Simular guardado
    setTimeout(() => {
      alert(
        "¡Configuración aplicada! Algunos cambios pueden requerir reinicio del servidor."
      );
    }, 1000);
  }

  // Inicializar tabs
  document.addEventListener("DOMContentLoaded", function () {
    const triggerTabList = [].slice.call(
      document.querySelectorAll('a[data-bs-toggle="list"]')
    );
    triggerTabList.forEach(function (triggerEl) {
      const tabTrigger = new bootstrap.Tab(triggerEl);

      triggerEl.addEventListener("click", function (event) {
        event.preventDefault();
        tabTrigger.show();
      });
    });
  });
</script>
{% endblock %}
